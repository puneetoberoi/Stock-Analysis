name: Test Learning Brain

on:
  workflow_dispatch:  # Manual trigger only
  push:
    paths:
      - 'src/modules/**'

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          
      - name: Install dependencies
        run: |
          pip install yfinance pandas numpy
          
      - name: Run Learning Brain Test
        run: |
          cd src/modules
          python test_learning_manually.py
          
      - name: Check Database Created
        run: |
          echo "üìä Checking database..."
          if [ -f src/modules/data/learning.db ]; then
            echo "‚úÖ Database created successfully!"
            ls -lh src/modules/data/learning.db
          else
            echo "‚ùå Database not found!"
            exit 1
          fi
          
      - name: Upload Database
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: learning-database
          path: src/modules/data/learning.db
